!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).VanillaCamera=n()}(this,function(){"use strict";var f=0<=["iPad","iPhone","iPod"].indexOf(navigator.platform),m=navigator&&navigator.mediaDevices&&"enumerateDevices"in navigator.mediaDevices;function g(n,e,i){navigator.mediaDevices.getUserMedia(e).then(function(e){n.srcObject=e,n.setAttribute("playsinline","true"),n.controls=!0,setTimeout(function(){n.controls=!1})}).catch(function(e){console.log("Error occurred ",e),i(e)})}function e(e,n){var i,t=void 0===n?{}:n,o=t.onError,r=void 0===o?function(){}:o,d=t.direction,a=t.size,c=void 0===a?1:a,u=t.area,v=void 0===u?1:u;i="string"==typeof e?document.querySelector(e):e,document.contains(i)||r("document.contains no found target");var s=document.createElement("video");s.width=i.clientWidth,s.height=i.clientHeight,s.controls=!1,s.style.background="#000",s.muted=!0,i.append(s),s.autoplay=!0,function(t,o){m&&navigator.mediaDevices.enumerateDevices().then(function(e){var n,i=e.filter(function(e){if("videoinput"==e.kind)return e});1<i.length?(n={video:{mandatory:{sourceId:i[i.length-1].deviceId?i[i.length-1].deviceId:null}},audio:!1},f&&(n.video.facingMode="environment"),g(t,n,o)):i.length?(n={video:{mandatory:{sourceId:i[0].deviceId?i[0].deviceId:null}},audio:!1},f&&(n.video.facingMode="environment"),n.video.mandatory.sourceId||f?g(t,n,o):g(t,{video:!0},o)):g(t,{video:!0},o)}).catch(function(e){console.error("Error occurred : ",e)})}(s,r);var h=document.createElement("canvas");"horizontal"===d?(h.height=window.innerWidth*c,h.width=window.innerHeight*c):(h.width=window.innerWidth*c,h.height=window.innerHeight*c);var l=h.getContext("2d");return{video:s,canvas:h,context:l,remove:function(){s.pause(),s.remove(),h.remove()},playPause:function(){s.paused?s.play():s.pause()},screenshot:function(){return l.drawImage(s,((1-v)*h.width+2)/4,((1-v)*h.height+2)/4,h.width*v,h.height*v,0,0,h.width,h.height),h.toDataURL("image/png")}}}return window.VanillaCamera=e});
