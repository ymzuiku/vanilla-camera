!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).VanillaCamera=n()}(this,function(){"use strict";var y=0<=["iPad","iPhone","iPod"].indexOf(navigator.platform),w=navigator&&navigator.mediaDevices&&"enumerateDevices"in navigator.mediaDevices;function I(n,e,i){navigator.mediaDevices.getUserMedia(e).then(function(e){n.srcObject=e,n.setAttribute("playsinline","true"),n.controls=!0,setTimeout(function(){n.controls=!1})}).catch(function(e){console.log("Error occurred ",e),i(e)})}function e(e,n){var i,t=void 0===n?{}:n,o=t.onError,a=void 0===o?function(){}:o,r=(t.direction,t.size),d=void 0===r?1:r,c=t.area,u=void 0===c?1:c,v=t.square;if(i="string"==typeof e?document.querySelector(e):e,document.contains(i)){var s=document.createElement("video");s.width=i.clientWidth,s.height=i.clientHeight,s.controls=!1,s.style.background="#000",s.muted=!0,i.append(s),s.autoplay=!0,function(t,o){w&&navigator.mediaDevices.enumerateDevices().then(function(e){var n,i=e.filter(function(e){if("videoinput"==e.kind)return e});1<i.length?(n={video:{mandatory:{sourceId:i[i.length-1].deviceId?i[i.length-1].deviceId:null}},audio:!1},y&&(n.video.facingMode="environment"),I(t,n,o)):i.length?(n={video:{mandatory:{sourceId:i[0].deviceId?i[0].deviceId:null}},audio:!1},y&&(n.video.facingMode="environment"),n.video.mandatory.sourceId||y?I(t,n,o):I(t,{video:!0},o)):I(t,{video:!0},o)}).catch(function(e){console.error("Error occurred : ",e)})}(s,a);var l=document.createElement("canvas");l.width=window.innerWidth*d,l.height=window.innerHeight*d;var f=l.getContext("2d"),h=100,g=100,m=200,p=200;return s.addEventListener("canplay",function(){var e=function(e){return[e.videoWidth||e.width,e.videoHeight||e.height]}(s),n=e[0],i=e[1];if(m=n*d,p=i*d,l.width=m,l.height=p,v){var t=n;i<n&&(t=i),g=h=t}else h=n,g=i}),{video:s,canvas:l,context:f,remove:function(){s.pause(),s.remove(),l.remove()},playPause:function(){s.paused?s.play():s.pause()},screenshot:function(){if(s)return f.drawImage(s,((1-u)*h+2)/2,((1-u)*g+2)/2,h*u,g*u,0,0,l.width,l.height),l.toDataURL("image/png")}}}a("document.contains no found target")}return window.VanillaCamera=e});
